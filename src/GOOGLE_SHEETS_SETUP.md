# ๐ ุฏููู ุฑุจุท ุงูููุฑู ุจู Google Sheets + Gmail

## โ ุชู ุชุญุฏูุซ ุงูููุฑู ุจูุฌุงุญ!

ุงูุขู ุงูููุฑู ุฌุงูุฒ ููุฅุฑุณุงู ุฅูู:
- โ Google Sheets (ุญูุธ ุงูุจูุงูุงุช)
- โ Gmail (ุฅุดุนุงุฑ ููุฑู)

---

## ๐ ุงูุฎุทูุงุช ุงููุงููุฉ:

### **ุงููุฑุญูุฉ 1: ุฅูุดุงุก Google Sheet**

1. **ุงูุชุญ:** https://sheets.google.com
2. **ุงุถุบุท:** + **Blank** (ุดูุช ุฌุฏูุฏ)
3. **ุณูููู:** "ุงูุณูุงู ููุชุงู - ุทูุจุงุช ุงูุนููุงุก"

4. **ูู ุงูุตู ุงูุฃูู (Row 1)ุ ุงูุชุจ ุงูุนูุงููู ุงูุชุงููุฉ:**

   | A | B | C | D | E | F | G |
   |---|---|---|---|---|---|---|
   | **ุงูุชุงุฑูุฎ** | **ุงูุงุณู** | **ุงูุดุฑูุฉ** | **ุงููุงุชู** | **ุงูุฅูููู** | **ุงูุชูุงุตูู** | **IP Address** |

5. **ูุณูู ุงูุนูุงููู:**
   - ุญุฏุฏ ุงูุตู ุงูุฃูู (Row 1)
   - ุงุถุบุท ุนูู ุฃููููุฉ **Bold** (B)
   - ุบููุฑ ููู ุงูุฎูููุฉ (Background color) โ ุงุฎุชุงุฑ ููู ูุงุชุญ
   - ุงุถุบุท **Text alignment โ Center**

---

### **ุงููุฑุญูุฉ 2: ุฅูุดุงุก Google Apps Script**

**ูู ููุณ Google Sheet:**

1. **ุงุถุบุท ูู ุงููุงุฆูุฉ ุงูุนูููุฉ:** `Extensions โ Apps Script`
2. **ูููุชุญ ูุญุฑุฑ ููุฏ ุฌุฏูุฏ**
3. **ุงูุณุญ ูู ุงูููุฏ ุงูููุฌูุฏ**
4. **ุงูุณุฎ ูุงูุตู ุงูููุฏ ุงูุชุงูู ุจุงููุงูู:**

\`\`\`javascript
// โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุดุฑูุน - ุบููุฑ ุงูุฅูููู ุจุชุงุนู ููุง ๐
const CONFIG = {
  NOTIFICATION_EMAIL: "your-email@gmail.com",  // ๐ ุถุน ุฅูููู ุงูุดุฑูุฉ ููุง
  COMPANY_NAME: "ุงูุณูุงู ููุชุงู",
  SHEET_NAME: "Sheet1"  // ุฅุฐุง ุบูุฑุช ุงุณู ุงูุดูุชุ ุบููุฑู ููุง
};

// ๐ ุงุณุชูุจุงู ุงูุจูุงูุงุช ูู ุงูููุฑู
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    
    saveToSheet(data);
    sendEmailNotification(data);
    
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        message: "ุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ!"
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({
        success: false,
        message: "ุญุฏุซ ุฎุทุฃ: " + error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

// ๐พ ุญูุธ ูู Google Sheet
function saveToSheet(data) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet()
    .getSheetByName(CONFIG.SHEET_NAME);
  
  const row = [
    new Date().toLocaleString('ar-EG'),  // ุงูุชุงุฑูุฎ
    data.name || "",
    data.company || "",
    data.phone || "",
    data.email || "",
    data.details || "",
    data.ip || ""
  ];
  
  sheet.appendRow(row);
}

// ๐ง ุฅุฑุณุงู ุฅูููู Gmail
function sendEmailNotification(data) {
  const subject = \`๐ ุทูุจ ุฌุฏูุฏ ูู \${data.name || 'ุนููู'}\`;
  
  const body = \`
ุชู ุงุณุชูุงู ุทูุจ ุฌุฏูุฏ ูู ูููุน \${CONFIG.COMPANY_NAME}

โโโโโโโโโโโโโโโโโโโโโโโ
๐ ุชูุงุตูู ุงูุทูุจ:
โโโโโโโโโโโโโโโโโโโโโโโ

๐ค ุงูุงุณู: \${data.name || 'ุบูุฑ ูุญุฏุฏ'}
๐ข ุงูุดุฑูุฉ: \${data.company || 'ุบูุฑ ูุญุฏุฏ'}
๐ฑ ุงููุงุชู: \${data.phone || 'ุบูุฑ ูุญุฏุฏ'}
๐ง ุงูุฅูููู: \${data.email || 'ุบูุฑ ูุญุฏุฏ'}

๐ฌ ุชูุงุตูู ุงููุดุฑูุน:
\${data.details || 'ูู ูุชู ุฅุฏุฎุงู ุชูุงุตูู'}

โโโโโโโโโโโโโโโโโโโโโโโ
โฐ ุงูุชุงุฑูุฎ: \${new Date().toLocaleString('ar-EG')}
๐ IP Address: \${data.ip || 'ุบูุฑ ูุชููุฑ'}

โโโโโโโโโโโโโโโโโโโโโโโ
ุชู ุงูุฅุฑุณุงู ุชููุงุฆูุงู ูู ูุธุงู \${CONFIG.COMPANY_NAME}
  \`;
  
  MailApp.sendEmail({
    to: CONFIG.NOTIFICATION_EMAIL,
    subject: subject,
    body: body
  });
}

// ๐งช ููุงุฎุชุจุงุฑ ููุท (ุงุฎุชูุงุฑู)
function testScript() {
  const testData = {
    name: "ุฃุญูุฏ ูุญูุฏ",
    company: "ูุตูุน ุงูููุฑ",
    phone: "01012345678",
    email: "test@example.com",
    details: "ูุญุชุงุฌูู ูุทุน ุบูุงุฑ ูุนุฏููุฉ\nุงูุฑุณููุงุช: ูุนูุ ูุฏู ุฑุณููุงุช",
    ip: "192.168.1.1"
  };
  
  saveToSheet(testData);
  sendEmailNotification(testData);
  
  Logger.log("โ ุชู ุงูุงุฎุชุจุงุฑ ุจูุฌุงุญ!");
}
\`\`\`

---

### **ุงููุฑุญูุฉ 3: ุชุฎุตูุต ุงูุฅุนุฏุงุฏุงุช**

**ูู ุงูููุฏ ุฃุนูุงูุ ุบููุฑ:**

1. **ุงูุฅูููู:**
   ```javascript
   NOTIFICATION_EMAIL: "your-email@gmail.com",
   ```
   ุถุน ุฅูููู Gmail ุงููุนูู ุงููู ุนุงูุฒ ุงูุทูุจุงุช ุชูุตูู ุนููู.

2. **ุงุณู ุงูุดูุช (ูู ุบููุฑุชู):**
   ```javascript
   SHEET_NAME: "Sheet1"
   ```
   ูู ุณููุช ุงูุดูุช ุงุณู ุชุงููุ ุถุนู ููุง.

---

### **ุงููุฑุญูุฉ 4: ุญูุธ ูุชุณููุฉ ุงููุดุฑูุน**

1. **ุงุถุบุท ุฃููููุฉ ๐พ (Save)** ุฃู **Ctrl+S**
2. **ูู ุงููุงูุฐุฉ ุงููู ูุชุธูุฑ:**
   - **Project title:** ุงูุชุจ "ุงูุณูุงู ููุชุงู - Form Handler"
   - ุงุถุบุท **Rename**

---

### **ุงููุฑุญูุฉ 5: ูุดุฑ ุงูู Script ูู Web App**

**ุงูุฎุทูุงุช ุงูุฏูููุฉ:**

1. **ุงุถุบุท:** `Deploy โ New deployment`

2. **ุงุถุบุท ุฃููููุฉ ุงูุชุฑุณ โ๏ธ** ุจุฌุงูุจ "Select type"

3. **ุงุฎุชุงุฑ:** **Web app**

4. **ุงููุฃ ุงูุจูุงูุงุช:**
   - **Description:** ุงูุชุจ "v1.0" ุฃู "ุงููุณุฎุฉ ุงูุฃููู"
   - **Execute as:** ุงุฎุชุงุฑ **Me (your-email@gmail.com)**
   - **Who has access:** ุงุฎุชุงุฑ **Anyone** โ๏ธ **ููู ุฌุฏุงู!**

5. **ุงุถุบุท:** ุงูุฒุฑ ุงูุฃุฒุฑู **Deploy**

---

### **ุงููุฑุญูุฉ 6: ููุญ ุงูุฃุฐููุงุช (Authorization)**

**ุณุชุธูุฑ ูุงูุฐุฉ ุชุทูุจ ุฃุฐููุงุช:**

1. **ุงุถุบุท:** `Authorize access`

2. **ุงุฎุชุงุฑ ุญุณุงุจู ูู Google**

3. **ุณุชุธูุฑ ุฑุณุงูุฉ ุชุญุฐูุฑ "Google hasn't verified this app":**
   - **ุงุถุบุท:** `Advanced`
   - **ุงุถุบุท:** `Go to [project name] (unsafe)`
   - ูุง ุชูููุ ุฏู ูุดุฑูุนู ุงูุดุฎุตู!

4. **ุงุถุบุท:** `Allow` ูููุญ ุงูุฃุฐููุงุช:
   - See, edit, create, and delete your spreadsheets โ
   - Send email as you โ

---

### **ุงููุฑุญูุฉ 7: ูุณุฎ ุฑุงุจุท ุงูู Web App**

ุจุนุฏ ุงูุถุบุท ุนูู **Deploy**:

1. **ุณุชุธูุฑ ูุงูุฐุฉ "Deployment"**
2. **ุงูุณุฎ ุงูู URL** ุงููู ุชุญุช "Web app":
   ```
   https://script.google.com/macros/s/AKfycbx.../exec
   ```

โ๏ธ **ููู ุฌุฏุงู:** ุงุญุชูุธ ุจูุฐุง ุงูุฑุงุจุท!

---

### **ุงููุฑุญูุฉ 8: ูุถุน ุงูุฑุงุจุท ูู ุงูููุฏ**

**ูู Figma Make:**

1. **ุงูุชุญ ููู:** `/components/FinalConversion.tsx`

2. **ุงุจุญุซ ุนู ุงูุณุทุฑ ุฑูู 21:**
   ```javascript
   const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE';
   ```

3. **ุงุณุชุจุฏูู ุจุงูุฑุงุจุท ุงููู ูุณุฎุชู:**
   ```javascript
   const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx.../exec';
   ```

4. **ุงุญูุธ ุงูููู!**

---

## โ **ุงุฎุชุจุงุฑ ุงูููุฑู:**

### **ุทุฑููุฉ 1: ุงุฎุชุจุงุฑ ูู Apps Script ูุจุงุดุฑุฉ**

1. **ูู ูุญุฑุฑ Apps Script**
2. **ุงุฎุชุงุฑ ุฏุงูุฉ:** `testScript` (ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ุจุฌุงูุจ ุฒุฑ Run)
3. **ุงุถุบุท:** `Run`
4. **ุงูุชุญ Google Sheet:** ูุชูุงูู ุตู ุฌุฏูุฏ ุจุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
5. **ุงูุชุญ Gmail:** ูุชูุงูู ุฅูููู ุชุฌุฑูุจู

### **ุทุฑููุฉ 2: ุงุฎุชุจุงุฑ ูู ุงููููุน**

1. **ุดุบูู ุงููููุน:** `npm run dev`
2. **ุงูุชุญ:** http://localhost:5173
3. **ุงูุฒู ููููุฑู** ูุงููุฃู
4. **ุงุถุบุท "ุงุญุตู ุนูู ุชูุงุตู"**
5. **ุงูุชุญ Google Sheet:** ูุชูุงูู ุงูุจูุงูุงุช
6. **ุงูุชุญ Gmail:** ูุชูุงูู ุงูุฅูููู

---

## ๐ฏ **ูููู ุงูุจูุงูุงุช ูู Google Sheet:**

ุจุนุฏ ูู ุทูุจุ ููุชุถุงู ุตู ุฌุฏูุฏ ููู:

| ุงูุชุงุฑูุฎ | ุงูุงุณู | ุงูุดุฑูุฉ | ุงููุงุชู | ุงูุฅูููู | ุงูุชูุงุตูู | IP |
|---------|-------|--------|---------|---------|-----------|-----|
| 26/12/2024 10:30 ุต | ุฃุญูุฏ ูุญูุฏ | ูุตูุน ุงูููุฑ | 01012345678 | test@email.com | ุงููุดุฑูุน: ูุทุน ูุนุฏููุฉ... | 1.2.3.4 |

---

## ๐ง **ุดูู ุงูุฅูููู ุงููู ูููุตูู:**

**ุงูููุถูุน:**
```
๐ ุทูุจ ุฌุฏูุฏ ูู ุฃุญูุฏ ูุญูุฏ
```

**ุงููุญุชูู:**
```
ุชู ุงุณุชูุงู ุทูุจ ุฌุฏูุฏ ูู ูููุน ุงูุณูุงู ููุชุงู

โโโโโโโโโโโโโโโโโโโโโโโ
๐ ุชูุงุตูู ุงูุทูุจ:
โโโโโโโโโโโโโโโโโโโโโโโ

๐ค ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ
๐ข ุงูุดุฑูุฉ: ูุตูุน ุงูููุฑ
๐ฑ ุงููุงุชู: 01012345678
๐ง ุงูุฅูููู: test@example.com

๐ฌ ุชูุงุตูู ุงููุดุฑูุน:
ุงููุดุฑูุน: ูุญุชุงุฌูู ูุทุน ุบูุงุฑ ูุนุฏููุฉ
ุงูุฑุณููุงุช: ูุนูุ ูุฏู ุฑุณููุงุช

โโโโโโโโโโโโโโโโโโโโโโโ
โฐ ุงูุชุงุฑูุฎ: 26/12/2024 10:30:00 ุต
๐ IP Address: 1.2.3.4
```

---

## โ๏ธ **ูุดุงูู ูุญุชููุฉ ูุญููููุง:**

### **1. ุงูุฅูููู ูุด ุจููุตู:**
**ุงูุญู:**
- ุชุฃูุฏ ุฅูู ุบููุฑุช ุงูุฅูููู ูู `CONFIG.NOTIFICATION_EMAIL`
- ุชุฃูุฏ ุฅูู ููุญุช ุฃุฐููุงุช Gmail ูู ุฎุทูุฉ Authorization
- ุฌุฑูุจ ุชุดุบู ุฏุงูุฉ `testScript` ูู Apps Script ูุจุงุดุฑุฉ

### **2. ุงูุจูุงูุงุช ูุด ุจุชุชุณุฌู ูู ุงูุดูุช:**
**ุงูุญู:**
- ุชุฃูุฏ ูู ุงุณู ุงูุดูุช ูู `CONFIG.SHEET_NAME`
- ุชุฃูุฏ ุฅู ุงูุนููุฏ ุงูุฃูู (Row 1) ููู ุนูุงููู
- ุงูุชุญ `View โ Execution log` ูู Apps Script ูุดูู ุงูุฃุฎุทุงุก

### **3. ุฑุณุงูุฉ "Script function not found":**
**ุงูุญู:**
- ุชุฃูุฏ ุฅูู ุญูุธุช ุงูุณูุฑูุจุช ูุจู ุงูู Deploy
- ุชุฃูุฏ ุฅู ุงุณู ุงูุฏุงูุฉ `doPost` ููุชูุจ ุตุญ

### **4. ุฑุณุงูุฉ CORS error:**
**ุงูุญู:**
- ุชุฃูุฏ ุฅูู ุงุณุชุฎุฏูุช `mode: 'no-cors'` ูู ุงูููุฏ
- ุฏู ุทุจูุนู ูุน Google Apps Script

---

## ๐ **ูููุฒุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู):**

### **1. ุชูุณูู ุชููุงุฆู ููุจูุงูุงุช:**

ุฃุถู ูู ููุงูุฉ ุฏุงูุฉ `saveToSheet`:

\`\`\`javascript
// ุชูุณูู ุงูุตู ุงูุฌุฏูุฏ
const lastRow = sheet.getLastRow();
const range = sheet.getRange(lastRow, 1, 1, 7);

// ุฅุถุงูุฉ ุญุฏูุฏ
range.setBorder(true, true, true, true, false, false);

// ููู ุฎูููุฉ ูุงุชุญ
if (lastRow % 2 === 0) {
  range.setBackground('#f9f9f9');
}
\`\`\`

### **2. ุฅุดุนุงุฑ ุตูุชู ุนูุฏ ุงุณุชูุงู ุทูุจ:**

ุงุณุชุฎุฏู Google Chat ุฃู Slack webhook ููุญุตูู ุนูู ุฅุดุนุงุฑุงุช ููุฑูุฉ.

### **3. ุฑุฏ ุชููุงุฆู ููุนููู:**

ุฃุถู ูู ููุงูุฉ ุฏุงูุฉ `sendEmailNotification`:

\`\`\`javascript
// ุฅุฑุณุงู ุฑุฏ ุชููุงุฆู ููุนููู
if (data.email && data.email !== 'ุบูุฑ ูุญุฏุฏ') {
  MailApp.sendEmail({
    to: data.email,
    subject: 'ุชู ุงุณุชูุงู ุทูุจู - ุงูุณูุงู ููุชุงู',
    body: \`
ุงูุณูุงู ุนูููู \${data.name}ุ

ุดูุฑุงู ูุชูุงุตูู ูุน ุงูุณูุงู ููุชุงู!

ุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ ูุณูุชู ุงูุชูุงุตู ูุนู ุฎูุงู 24 ุณุงุนุฉ ูู ูุจู ูุฑูููุง ุงูููู.

ุชุญูุงุชูุงุ
ูุฑูู ุงูุณูุงู ููุชุงู
ุงูุนุงุดุฑ ูู ุฑูุถุงู - ุงูููุทูุฉ ุงูุตูุงุนูุฉ ุงูุซุงูุซุฉ
    \`
  });
}
\`\`\`

---

## ๐ **ุฅุญุตุงุฆูุงุช ูุชูุงุฑูุฑ:**

ููููู ุนูู Dashboard ุจุณูุท ูู Google Sheets:

1. **ุงุถุบุท:** `Insert โ Chart`
2. **ุงุฎุชุงุฑ:** ุนุฏุฏ ุงูุทูุจุงุช ุญุณุจ ุงูุชุงุฑูุฎ
3. **ุดุงุฑู ุงูุดูุช** ูุน ูุฑูู ุงููุจูุนุงุช

---

## ๐ **ุฌุงูุฒ ููุงุณุชุฎุฏุงู!**

ุจุนุฏ ุงุชุจุงุน ูู ุงูุฎุทูุงุช:
- โ ุงูููุฑู ูุฑุณู ุงูุจูุงูุงุช ูู Google Sheets
- โ ุชุณุชูู ุฅูููู ููุฑู ุนูู Gmail
- โ ุงูุจูุงูุงุช ูุญููุธุฉ ูููุธูุฉ
- โ ูุฌุงูู 100% ููุณุชูุฑ

**ุจุงูุชูููู! ๐**
